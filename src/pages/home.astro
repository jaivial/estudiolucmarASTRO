---
import LayoutMenu from '../layouts/LayoutMenu.astro';
import HeroSection from '../components/home/HeroSection.astro';
import LoadingScreenThree from '../components/LoadingScreenThree.astro';
---

<script>
  import axios from 'axios';
  import Toastify from 'toastify-js';
  function showLoadingScreenThree() {
    const loadingScreen = document.getElementById('loading-screen-Three');
    loadingScreen.classList.remove('hidden');
    loadingScreen.classList.add('flex');
  }
  function hideLoadingScreenThree() {
    const loadingScreen = document.getElementById('loading-screen-Three');
    loadingScreen.classList.remove('flex');
    loadingScreen.classList.add('hidden');
  }

  showLoadingScreenThree();

  axios
    .get('http://localhost:8000/backend/auth/check_login_status.php', {
      withCredentials: true,
    })
    .then(function (response) {
      if (response.data.loggedIn) {
        Toastify({
          text: 'Sesi√≥n iniciada',
          duration: 2500,
          destination: 'https://github.com/apvarun/toastify-js',
          newWindow: true,
          close: false,
          gravity: 'top', // `top` or `bottom`
          position: 'center', // `left`, `center` or `right`
          stopOnFocus: true, // Prevents dismissing of toast on hover
          style: {
            borderRadius: '10px',
            backgroundImage: 'linear-gradient(to right top, #005d09, #0b6316, #146921, #1d6f2b, #247535, #267a39, #287e3d, #2a8341, #278740, #248b3f, #20903e, #1c943d)',
          },
          onClick: function () {}, // Callback after click
        }).showToast();
      } else {
        window.location.href = '/';
      }
    })
    .catch(function (error) {
      console.error('Error checking login status:', error);
    });

  hideLoadingScreenThree();
</script>
<LayoutMenu title="Lucmar Cloud">
  <HeroSection />
  <LoadingScreenThree />
</LayoutMenu>
